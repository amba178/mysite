language: ruby
rvm:
- 2.3.1
before_install:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- mysql -e 'CREATE DATABASE mysite_test'
script:

- bundle exec rails db:create:all
- bundle exec  rails db:migrate
- bundle exec  rails db:schema:load
- bundle exec  rails db:test:prepare
- bundle exec  rails spec
- bundle exec  rails cucumber
services:
- redis-server
env:
  global:
  - secure: UOjkzfbyPq3BA8Q4s2u1KHrQcgJQgr8RpW66b5ex/cKljQQs8Teva57xXfd1/0CVfYSUk8jEeuxyfryAx5WE0JwsjuNKsXOTGeoN28B5udx42MsBVR1MhdqnivSFWegTlRj2GgRdVtnQP+YBtqVjl3/zHOYSko3DP7HQgv8aHXdyja2EHjVZXMoriegFhdHbfXEwR7h4Xa/0yl7rNChDxX1tthDKj7cqv+YbX7b3Y42eNHkpGr02pIGGLxuanbCZFATO1Vzr4ll6K2qsY/F9rlptXgOL2S2FIJux3x/vi48L+OK5GYb1t2BvKj0Sd/vU1he8yoTKRrZdCYkHs68j/6v3j2Ob+b0Qf8lPXnTmN8NtQqlB18UiIuctxbU51sRPZbQ5Q+Tffi1GMXSeAymQfTouCPE47gPoy2+3Ns0T/MluxuBG/DgzZcIKiviLD21a/U9FP5YkMtf9psUOoevUw7bVj6Gu/56JMxB6d84zLAfQcu8EogOPMdx0Bm1SCQbfhjpfT8r9ecNF044rK96FH+VZ/k4xWHk4NpDyLM36E3yOn+VZ/zMMppAhwjJxMeQCkQFjDW6Lt+D8UdV59Gjfev5Mw+QIY5kbpfnkunG+QIF8ysZAWtLP1DhuIDNi2IbgU6GVonM12mi8er+43GewHCdMql0pZJMf0oD6caHysIw=
  - secure: t+aslOf6gLRBzDDyxJ83yswkQGJlnwsRVob6AEqo941FLTnnH+064Le9SOGxyLeUV9Td/CaImKmhbgKakbkIJE9FHCl0sWCsKZkPzxGbIbBwreJUWIKC8Hg/irZTTnZ2bYP4+vOTjm3BV9jmpgxCzz2XUXVH/lc7OQbBDLc0svmnW6bjBilPh67xS9ntff69RPyNMijBxtSB94mg06cLEJmqUBD+6V7qMphYxyGEbpjzb2r/+FCeUdzhr3+CgwB3UbxmOZkDm5EQEYAUGUXHn7z633kaWbzdP6xhlw2q7WQzK4T+iXTqip9akpfMTfxhw786h8oylISzfoTfE5WNSKQ89B36bH8Elul8b+HKRdDSxaolTN0V5eMuncq41SfGtFbtpp/IAwRgSKtH6rjmfMJ5jJq4skY3sH2+Dfzd9zJkIxcDCtF+5czXly15GDjzJ2fwCtFMIquyaDcirkOGv70kmcW6b+QIZSNABChYXAT6IOfQmiw4/9UldYT/CAjhOQlAMgjmyE7igvfx6UGxXRsjKohPMW1+p67sx+/+NrjR4Bf8OVU6V41mI7OHg25t9pgxkX7htW7AWhRuSskJ7KmLo0OurCtrHVLlJ7ytW5vVB7PBfZJhxQpFdjF7xQk6837WCQjO5gX5N65C8ezhF2RR9QgUfsLmbudzLFBfg/A=
  - secure: gOUQ5N0EYx4thBS4RwwDvAH1QlpmLqBHRMNXoy+NSzFs2RWIyUL3R1P4HiDPyWe2RLvFNbWbMvSPW4e6+BD9Ehmk5pTDqeW6Ks10ow42ZjeEJZK6gTJpphHnYTlmMmopbuc56a6lgJhE5q85IfsAFqtZLHdqEi5Dz6b9KJVBCjRx2pboShIxf+mYHMNvc6DX4KybvkqPTXrh40MspUHwjTYXdHb2udeRPgKJdCnrONyRUFiRfu/KrStXrTyuDH1N7GTzFOJPkl9axb13kTDfTOyuSdx/q3hIp3KF2Isn+haU2Du7cQq9fUU7lh1UW5JXoWrKebd54mTVLl8HL6jwI59pkDZIsTuSxPJlzSNfK6374n2/jYVm3+tRIA4eMQNlaEhcTLDtuddnjcg1/RYUakZSpmPFFOw6GuJcUBGJcMBlGaoKMZ9LfcIEf9lQ4Jw0ulwS4HsMJZTUTmpMAy7/5CmobAyn40h5Ty+d0NvIDYc/cOlo0ZxkHwkxP6Tbkx0NHhy0z+0mV0+w+roYmQPNtYvYHzAJDKHLKNV9Uo3OwjRb3H0GqQhLMMk0TdLu2CVnDekXG9xilQ0yKEF+t2AyEIvXvKDVz5QDdT2Z9m2G/9SlOWY/LHKBsLwgRYzDzjRddNoaodIJeavLk1v5d1GEhzm49H1YZMqYqLPqrYaBqZU=
  - secure: JZFyRkWKSPHSRembuuI3TgFQo5hA6wolywTQt1R8VsDmRrYQggubPhT7Cigm9x8oP5h64Joe30aerddAeqmtk5t+JfPU043YYqhz6JkMFp7xeTsxIT1K6cM1XRFnAmA+Ya6KVynFYwx0WXYJ5Yf4fon7vJ0gY4/EeJeymr4UvC01ditfpmdjXAUSaFRGO1uxeVBbeET/MxpMCN7zVVRlPXyNwp/boB263oczeyl1nPb6sopJ9FZlqj/if/3AF5GeNlZrFAQXt/Egm8yfM4x9spZinFBISR9hdqSfMxKbbKZYuHrNr/Ae4E207OkG4V3edqUB8kfvn41GX4siqBob7rpb1MushL9tHqqNI3jMYOH1KHwu4P6KXwmuB6sx3qm76hIAnPA8ZkQwkMeejRy4yhK1qX04Dv0A7WkJxLGwc1ldh/vzMOufCREp4B1899anQpu/HY4tJX1xDNH0twAquGVoXbQBrPyQdZXUk7ZqPG+geK/0hVJdtPgNc+BIW9Mki7G4zxBEUPxs+8iN0cfEISOGvaPk+X9RLE/9TM0RtW+i8OA0eGJBZ6CG78u9nr9gOXXzJ0VJSjaDKiETE4UaV6BXdihrMgzuROpfZeITtNVvqcic3FU0VBmS1wrUYNELiXes5XrZ/6GQ37geI6cHWDEmw2GgCTGVS0fvICZA4e0=
  - secure: yBzIUDXBEkFpvSJhBCar2U7IQs6ByDbr9kOmvnPqxu2l/fUy1FrzJ0dieKdcMvpDXMWDu+3eqelMz822xnFEbFhvd1iRnjewKUgH8PK3LnNqVc03PAtbuzcmB4+l3KK3tfX5UMl+oloz0y4d9M45JsatQyZT/SETp9YQhl+aTsjxCsd58bm0gBEg+9YnWH9CJKJB/a2YQTfKNokbm40aIn3+/gJ0fzSzRYKGtVwoh6mOZKUm2GiSsxss+v1k5lVAOuQMi4aYVanOqmuC+7/Q9/JZaEaqvpKCCFP2Iv4LLrBg3IjBd9Kv2guEpm25yecUP/1e5+Wt2dLXB/GNTNLVdoCn2EwhYFFQodzIJs9vfjRHfva3T2gANNAWgLxWoSEdy2HGNeYXQki8Mvrir3wZECMU6T2/PKfS2wgaqTeLO7EoMzpgtXh/gR1YWrbmUHvp653ZgrUbTuOMMOnNHWNdAPzBP0zag4x5kTCMMnldHQ/ZBtICSNiywwU1HLvwHbCFAIdPLOXfWs02eYGl8lXgKKJuu+J3IBssxpjFWnNyCHj7qtRYXhuIe/5byTaBLNoqMOjZUk6Vc5a7Odd2jZmj3n83oqcK2eU8jeRU7oQpCDIMRmwDmEYQx7EeUFf4kEJ3gwu+zoTf1uy06ySjhGkhMviJcG0UNjdjEIjvLISMlcg=
  - secure: jh89g0FABi8YdLOyrC18eQcQWtCVt6zT2QNKC4Fb/R4gygXSQJcJ5f30rYnwqcshaVvl6EBAhoGEFI/beW7b5f9TdgCP7rivVcpgvM1F7juYodW/FI5crvWo86B2j6qQktG9dI7GJHtjtneAUMgL3jDExo7QDJnMkRMYABwUzUDKGQodgSOcpgJf2DkkfNKI4/5QjWHkJDrjbYt+tBNIcjqPHl8AmD59oqVdSyEgRJjLMd0J4M3+Ndf6gQm/3Hk1gcmpvInOvqezqubw0JD2rGubMJ7TZy3k097aLiL39D347z3BAkJx8KzWnibKLHhLfoS1X6nzipwYycvRMxgx6HO8StiZGd/rBEdbEM8yTdQ5NouxptSFxws8LbfVocchNxQA+Ww1dMWDm/ZBOkywFyIPTkAYm58I10M7xkj+KES7ZMx8Svtukgq73Ix7F9tX/PxnthS65gSweJAyeeF7rkJ6IpBfaW9TbtO7ytPD1PcOR4Ft68yCujl3xwFRXUIBg8HmLbidcVpA17294yKwTp+YIDxu0cT3qeNnyPuFxXIOMbqO3rk69AvDVRJa4byRv0Berv9AQpkh1cAkt7PuyumeD1oR0kuaXV+QwVSYWuU4P7Zp7Ei/xQNkkcn1XcZm2JIABkf9I4anFlSUWA2KMr8YVrnbXOc9mSBboWmKBTw=
  - secure: ONS09IVCr0DSAMvfEBq7RZErnT/Lu9Nn3BWoQerdcqVA9EpSAi1zkIG6tcD4d9XYkZ5l4lbyNo5XN2YoPuaIlB1hu1YCTEiAVmbwKd52eIsKBN2lTLPb0XJ6BtNaiPHJqlVhRdFTC2RISQ/49pzkVU4OXIFYviOcjqcrpM6L9Xo3sMnO3tTlScaTefp8bl/sM6g0lbextcX+74XhbrumAzdLa/Z6JbaT8CIxQSUVDLqKNxd3RK5p3jqFiFEr6JfvzBOyrV2YhWDdY+QlvmJdHbb4ZoE+/m/NfVSxv97QG/DvSNUCswD8Y/rCMxdBktMGLvy2bF1VKmZM9xEgfjdzmCTnuKiFRcnYw37m52XrqcC6gNlFQuIlVEEko3mUT9jgVLRzRNTULswMGeAYidhDFzFk0s4MDKOYxrI1Y/vKfhVawMMQ1i9GaWpZuSWo/66aKbDQgRpiBgtjFgc1hjlfqwaFBtsQJR48P+TfaazBUIBjoUs7AVNeCd4/876n0hw1OS7mBt/5YUMBMEQ3iaSZKl7xDKe4XLKNG8txjiTBKYol1iW6/hDaTrr/4gIAk2mYeRqD35bj3TP3L8V6XduqecRJaIx0qPvVMjRwG+ytz/Z4GkED9gMcN7Mt+VJmul03tF+cfr6WMhz7r+7jH4KpTj9QbFm0KlB3KegI1h+Hv/E=
  - secure: WwrFZO5GeeYoUqaerOermp6BbBzTXQJHP7sk2uTV+stL0oHk4HsWWQtxd8BF/0uLu/aIhpXMQISXP3vv2ZS3H5++TXy5piVu6TDuRXc9+MRAxn1NNAZ9X7No3jjNoEr68WtiRhwQj8RZasKSFYbn5r9ojrxhdSPY7twF5jFWRIjGG5jWDD79kr75EMjmTs0ix3evJLVjNTitph1TDxLlCxJzHo9EtDvosiLzOT0MI1KCHk3Igh5F8tdd1JhSJzVJX9Ssbc7+JKiGHtH7B/yDIu4tbriliq8/SptdU9irFfZKNLPR5QloVj21dNUcnwSA3udq7dJLRfEXtU/Zh4g+ymV+Ge42LdL9KdFQtJa+YmMVEqpO5hot2L8iYxh/tlkhzAvjYlDa5FAOZOtLsX9l2awr7/qg/hkIO6aGWRqxgsiMhn+EypxgufUwDSJzffgGHSVVVruk5SSzDY9bPvS2cgCME+q4BY4o9S7PtUPTzJxT7Tiw8XzjlXAZEmuO7/txh0Hpit2tJ02kA/VlCmudxqLcG7/6YccrMzVp+4Pui70BuXM/uS4XWdqDArlKVUGF7XvZA0BunEMwfq/XueBkapwhoOVReexWZzMMdRcyakZGEk0VsvwbFkoKEqwyUq4+2TVxFlVC4pv8U77TX27hMoWXRfWpVqGoeGHlD3xabD8=
# deploy:
#   provider: heroku 
#   api_key:
#     - secure: Bc8qVTJ0JaP6BeMG4Nf2nlAnxiqXdVdkXV37RCJmJugA8d04nAB2t7KBEwNNYC0R1uZn7gheZXhHMVJyfkX3OQ5J6DKgFigCPw+cFBFiWp26Jo/dEZbcAB7OO/KtcLI8P4vF0vkW7pUekB0zIefcxM/xO8fYC37ViOLg/bD19spOza7eVTwD7l5T/4ehn0QaZZZssnm8GF549tfZHcS8dBiKPoXITDm3ofYF1ubo0GJh6T6HSdFUe0yuEKVVC3AYXW48yXJb4SoADQcsVkZjRIHjZJxqplHUVOPC3BlLY9dL8INbqJZT8t13iMpEBQZmenBPmEJJYTW8f+uBSx5bAZgggpp7JS1I4Xx0jLizZA84KnzMAuwRCfznpWkj98VPv4ZGOgQPWWKh1G5DKXwcVYfNhn8J3djvstlwdhU0AN7aSi6Xs9SH/OZ7zcDGSSYenEGvvlEj9yubtUaxZZy/eUePkO4/42EFw4N5ZuD5Gu2JAGKdWUCAKC/cqylmWpN2NmPui3kyjHxiM/lup9qEbROXZJDIVB5VsjeJ5gBsvxLugHr20r2UYSpmcP62szlUlqnvCZp/K40Ro1oBm5Yf9l6U42oO9NABlaY+ah1ut1QRgtRFymPl1N7EJDc/y2ElZ9Isq98Fp8dcfqGk1FUwXctqhYQKpOBzEGYWB0LMdEo=
#   app: develop-sagan
#   run: 
#     - rake db:create
#     - rake db:migrate
#     - rake cleanup
